# This is a template for the heron pipeline to interact with asimov
# You should use this in conjunction with the asimov package
# rather than directly editing this file to set up an analysis.
# PRODUCTION: {{ production.name }}
# EVENT: {{ production.event.name }}

name: {{ production.name }}

logging:
  level: {{ production.meta.get('logging', {}).get('level', 'warning') }}

pages directory: {{ config['general']['webroot'] }}/{{ production.event.name }}/{{ production.name }}

{% if 'injection' in production.meta %}
injection:
  parameters: {{ production.meta['injection']['parameters'] }}
  duration: {{ production.meta['injection'].get('duration', 32) }}
  sample rate: {{ production.meta['injection'].get('sample rate', 4096) }}
  interferometers: {{ production.meta['interferometers'] }}
  psds:
    {% for ifo in production.meta['interferometers'] -%}
    {{ ifo }}: {{ production.meta['injection']['psds'].get(ifo, 'aLIGOZeroDetHighPower') }}
    {% endfor %}
{% endif %}

inference:
  name: {{ production.name }}

  interferometers:
    {% for ifo in production.meta['interferometers'] -%}
    {{ ifo }}: {{ ifo }}
    {% endfor %}

  psds:
    {% for ifo in production.meta['interferometers'] -%}
    {{ ifo }}: {{ production.meta.get('psds', {}).get(ifo, 'aLIGOZeroDetHighPower') }}
    {% endfor %}

  {% if 'data' in production.meta %}
  data: {{ production.meta['data'] }}
  {% endif %}

  {% if 'event time' in production.meta %}
  event time: {{ production.meta['event time'] }}
  {% endif %}

  {% if 'segment length' in production.meta %}
  segment length: {{ production.meta['segment length'] }}
  {% endif %}

  {% if 'after merger' in production.meta %}
  after merger: {{ production.meta['after merger'] }}
  {% endif %}

  {% if 'likelihood' in production.meta %}
  likelihood: {{ production.meta['likelihood'] }}
  {% endif %}

  {% if 'sampler' in production.meta %}
  sampler: {{ production.meta['sampler'] }}
  {% endif %}

  {% if 'priors' in production.meta %}
  priors: {{ production.meta['priors'] }}
  {% endif %}

  {% if 'waveform' in production.meta %}
  waveform: {{ production.meta['waveform'] }}
  {% endif %}
