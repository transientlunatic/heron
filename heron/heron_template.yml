# HERON CONFIGURATION FILE
# PRODUCTION: {{ production.name }}
# EVENT: {{ production.event.name }}

name: {{ production.name }}

injection:
  parameters: {{ production.meta['injection'] }}
  injection model: {{ production.meta['injection model'] }}

interferometers: {{ production.meta['interferometers'] }}

likelihood:
  sample rate: {{ production.meta['likelihood']['sample rate'] }}

{% if "noise model" in production.meta %}
noise model: {{ production.meta['noise model'] }}
{% endif %}

data: {{ production.meta['data'] }}

{%- assign priors = production.meta['priors'] %}
priors:
{%- if priors.keys() contains "geocentric time" %}{%- assign p = priors['geocentric time'] %}
   gpstime: {{p['type'] | default: 'Uniform' }}(name="gpstime", minimum={{p['minimum']}}, maximum={{p['maximum']}}, boundary={{p['boundary'] | default: None}})
{% endif %}
{%- if priors.keys() contains "total mass" %}{% assign p = priors['total mass'] %}{% else %}{% assign p = None %}{% endif %}
   total mass: {{p['type'] | default: "Uniform" }}(name='total mass', minimum={{p['minimum'] | default: 1}}, maximum={{p['maximum'] | default: 1000}})
{%- if priors.keys() contains "mass ratio" %}{% assign p = priors['mass ratio'] %}{% else %}{% assign p = None %}{% endif %}
   mass ratio: {{p['type'] | default: "bilby.gw.prior.UniformInComponentsMassRatio" }}(name='mass ratio', minimum={{p['minimum']}}, maximum={{p['maximum']}})
{%- if priors.keys() contains "luminosity distance" %}{%- assign p = priors['luminosity distance'] %}
   distance: {{ p['type'] | default: "PowerLaw"}}(name='distance', {% for key in p.keys() %}{% if key != "type" %}{{key | replace: " ", "_"}}={{p[key]}},{% endif %} {% endfor %} unit='Mpc')
{% endif %}
{%- if priors.keys() contains "theta jn" %}{% assign p = priors['theta jn'] %}{% else %}{% assign p = None %}
   theta_jn: {{p['type'] | default: "Sine" }}(name='theta_jn', minimum={{p['minimum']}}, maximum={{p['maximum']}})
{% endif %}
   dec: Cosine(name='dec')
   ra: Uniform(name='ra', minimum=0, maximum=2 * np.pi, boundary='periodic')
   psi: Uniform(name='psi', minimum=0, maximum=np.pi, boundary='periodic')
   phase angle: Uniform(name='phase angle', minimum=0, maximum=np.pi, boundary='periodic')

waveform: {{ production.meta['waveform'] }}

report:
  location: {{ config['general']['webroot'] }}/{{ production.event.name }}/{{ production.name }}
